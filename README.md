# FormAI Dataset

![LOGO](https://github.com/FormAI-Dataset/FormAI-dataset/assets/138256298/3b730b10-2681-472f-aeb7-3e97a7cfa61a)

# Description 

FormAI is a novel AI-generated dataset comprising 112,000 compilable and independent C programs.   All the programs in the dataset were generated by GPT-3.5-turbo using dynamic zero-shot prompting technique and comprises programs with varying levels of complexity. Some programs handle complicated tasks such as network management, table games, or encryption, while others deal with simpler
tasks like string manipulation. Each program is labelled based on vulnerabilities present in the code using a formal verification method based on the Efficient SMT-based Bounded Model Checker (ESBMC). This strategy conclusively identifies vulnerabilities without reporting false positives (due to the presence of counter examples), or false negatives (up to a certain bound). The labeled samples can be utilized to train Large Language Models (LLMs) since they contain the exact program location of the software vulnerability.

# Cite

Paper accepted for Publication: 19th International Conference on Predictive Models and Data Analytics in Software Engineering (PROMISE 2023), December 8, 2023, San Francisco, CA, USA

Preprint: https://arxiv.org/pdf/2307.02192.pdf

Cite dataset: https://dx.doi.org/10.21227/vp9n-wv96

Cite paper: https://doi.org/10.48550/arXiv.2307.02192

# Architecture

The dataset includes three files:

**a. FormAI_dataset_C_samples-V1.zip** - This file contains all the 112,000 C files.

**b. FormAI_dataset_classification-V1.zip** - This file contains a CSV file with the following six columns: 1. File name, 2. Vulnerability classification, 3. C source code, 4. Vulnerable function name, 5. Line number, 6. Vulnerability type. One C program can contain multiple vulnerabilities. As such this file has 246550 rows. In the fifth column, each C program preserves the structure of the original code by containing the newline character.

**c. FormAI_dataset_human_readable-V1.csv** - Human readable version, containing only 5 columns without the C code.

The design and methodology behind the creation of the FormAI dataset are depicted in the subsequent figure.

![architecture](https://github.com/FormAI-Dataset/FormAI-dataset/assets/138256298/5dd74a55-d46b-4cf7-9345-5b455bd29185)




# Instructions 
All C programs in this dataset were generated by GPT-3.5-turbo. From the entire dataset 109,757 sample files can be compiled using only the command 'gcc -lm'. However, the remaining 3% of samples are more complex, utilizing external libraries such as OpenSSL, sqlite3, and others. After installing the required dependencies, all files should compile without any issues.

The FormAI dataset is suitable for machine learning training, testing vulnerability detection softwares, and various tasks that require a substantial collection of C files. 

In this guide, we illustrate the process of classifying the samples in the FormAI dataset and how to extract the C source code from the categorized csv files. This serves as an ideal foundation for those looking to build upon these findings in future research.

1. Start by obtaining the entire FormAI dataset from Github with the given command:

   ```bash
   git clone https://github.com/FormAI-Dataset/FormAI-dataset/
   ```

2. The following sequence of commands includes an operating system upgrade and the installation of the build-essential package, a crucial requirement for the proper compilation of the dataset. 

   ```bash
   sudo apt update && sudo apt upgrade -y && sudo apt install build-essential -y
   ```
3. The subsequent step involves installing all the necessary dependencies to compile the 112,000 C files present in the dataset.

   ```bash
   # Essential compilation tools, like gcc and make.
   sudo apt install -y build-essential
   # Installing csvtool and unzip packages
   sudo apt install -y csvtool unzip
   # SQLite3 development files, useful for building apps with SQLite3 support.
   sudo apt install -y libsqlite3-dev
   # Development files for OpenSSL, for apps with SSL support.
   sudo apt install -y libssl-dev
   # MySQL/MariaDB client library development files.
   sudo apt install -y libmysqlclient-dev
   # PostgreSQL client library development files, for apps with PostgreSQL support.
   sudo apt install -y libpq-dev
   # Portable audio I/O library, runtime version.
   sudo apt install -y libportaudio2
   # Portable audio I/O library, development files.
   sudo apt install -y portaudio19-dev
   # Library for network monitoring; development files.
   sudo apt install -y libpcap-dev
   # QR code encoding library; development files.
   sudo apt install -y libqrencode-dev
   # Simple DirectMedia Layer development files, a library for making games.
   sudo apt install -y libsdl2-dev
   # OpenGL Utility Toolkit (GLUT) development files.
   sudo apt install -y freeglut3-dev
   # Development files and documentation for libcurl (OpenSSL flavour).
   sudo apt install -y libcurl4-openssl-dev
   
   ```
 
4. Unzip the .C samples from the compressed file (this action will generate a DATASET directory containing all the files):

   ```bash
      unzip FormAI-dataset/FormAI_dataset_C_samples-V1.zip && unzip FormAI-dataset/FormAI_dataset_classification-V1.zip
   ```

5. One can verify the successful installation of the dependencies by testing 1000 files from the dataset. This command will verify that the first 1000 files from the dataset compile successfully (this process usually takes around 2-3 minutes). 

   ```bash
      find DATASET -name "*.c" | head -n 1000 | xargs -I{} bash -c 'gcc {} -w -lcrypto -lsqlite3 -lmysqlclient -lpq -lssl -lportaudio -lpcap -lqrencode -lSDL2 -lglut -lGLU -lGL -lcurl -lm &>/dev/null &&  echo {}' | wc -l
   ```
6. If the result is 1000 from the previous run, it indicates that all the tested files were compiled without issues. Our system is ready to use the provided files. To retrieve and compile the C code from a specific row in the FormAI_dataset.csv, use the command below (taking row number 3679 as a example):

   ```bash
   gcc -x c <(csvtool drop 3679 FormAI_dataset.csv | csvtool -t ',' head 1 - | csvtool -t ',' col 3 - | sed 's/^"//; s/"$//' | sed 's/""/"/g') -lm -lcrypto -lmysqlclient -lpq -lssl -lportaudio -lpcap -lqrencode -lSDL2 -lglut -lGLU -lGL -lcurl -o output
   ```

7. Each program is categorized according to the vulnerabilities found in its code, using a formal verification technique that leverages the Efficient SMT-based Bounded Model Checker (ESBMC).

   ESBMC is a mature, permissively licensed open-source context-bounded model checker for verifying single- and multithreaded C/C++, Kotlin, and Solidity programs. It can automatically verify predefined safety properties (e.g., bounds check, pointer safety, overflow) and user-defined program assertions.

   The Github page for ESBMC can be found at the following link: https://github.com/esbmc/esbmc
   ESBMC depends on numerous external tools and has a variety of intricate dependencies, from SMT solvers to more complex ones. Nevertheless, there's an option to utilize a pre-compiled binary version, which can be obtained using the command provided below:

   ```bash
   wget https://github.com/esbmc/esbmc/releases/download/nightly-b0f3451fd011533120376edddc36936bc4ea5073/esbmc-linux.zip && unzip esbmc-linux.zip && rm esbmc-linux.zip && chmod 777 linux-release/bin/esbmc
   ```
8. If you wish to test ESBMC on an individual file from the FormAI dataset, use the command below (taking FormAI_14569.c as a reference):

   ```bash
   linux-release/bin/esbmc DATASET/FormAI_14569.c  --overflow --memory-leak-check --timeout 30 --unwind 1 --multi-property --no-unwinding-assertions

   ```
   The file appears to be vulnerable, revealing a buffer overflow in the scanf() function. Below is the output from ESBMC:

    ```
      State 6 file FormAI_14569.c line 24 column 9 function main thread 0
      ----------------------------------------------------
      Violated property:
        file FormAI_14569.c line 24 column 9 function main
        buffer overflow on scanf
        0
   
      VERIFICATION FAILED
   ```

9. As a concluding action, you can confirm that this vulnerability is indeed present in the FormAI dataset by executing the command below:

   ```bash
   cat FormAI-dataset/FormAI_dataset_human_readable-V1.csv | grep 'FormAI_14569.c'
   ```
The outpus is the same as ESBMC found :  `FormAI_14569.c,VULNERABLE,main,24.0,buffer overflow on scanf`


 # Disclaimer 

   
SHA256 checksum of the files:

`FormAI_dataset_C_samples-V1.zip : fc458020ad0e9b0999882d4bfdd27edfdee2f0ff5de22848e11352d64230ca47`
`FormAI_dataset_classification-V1.zip : 82b00611d71ff992d85b7bba20ebece580bfd055939b0142861326dff17ede74`
`FormAI_dataset_human_readable-V1.csv : 316d7145006f48ec42c9a89b1dccb2c5e2c05012c926af65c0269aba45d47830`

WARNING: BE CAREFUL WHEN RUNNING THE COMPILED CODES, SOME CAN CONNECT TO THE WEB, SCAN YOUR LOCAL NETWORK, OR DELETE A RANDOM FILE FROM YOUR FILE SYSTEM. ALWAYS CHECK THE SOURCE CODE AND THE COMMENTS IN THE FILE BEFORE RUNNING IT!!!
